<!DOCTYPE html>
<html>
<head>
    <title>Project 5</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
    </style>
    <style>
        table {
            width: 80%;
            border-collapse: collapse;
            margin: 20px auto;
        }
        td {
            text-align: center;
            padding: 10px;
        }
        img {
            width: 100%;
            height: auto;
        }
        caption {
            font-size: 1.2em;
            font-weight: bold;
            padding: 10px;
        }
        .caption {
            font-weight: bold;
            font-size: 1em;
            padding-top: 5px;
        }
    </style>
</head>
<body>
    <div class="navbar clear nav-top">
        <div class="row" style="text-align: center;">
            <h1> Project 5: Fun With Diffusion Models! </h1>
        </div>
    </div>
    
    <h1> Project 5A: The Power of Diffusion Models! </h1>

    <h2> Background </h2>
    <p> 
        idk
    </p>

    <h2> 0. Sampling from the Model </h2>
    <h3> Approach </h3>
    <p>
        In this part, I used <code>num_inference_steps=20</code> for Stage 1 and <code>num_inference_steps=5</code> for Stage 2. The images are shown below.
    </p>
    <img src="media5a/part0model2changedto5.jpg" style="width:300px;height:auto;" alt="part0model2changedto5.jpg">
    <div class="caption"> Stage 1 with <code>num_inference_steps=20</code> (Top) and Stage 2 with <code>num_inference_steps=5</code> (Bottom) </div>

    <h2> 1.1 Implementing the Forward Process </h2>
    <h3> Approach </h3>
    <p>
        In order to implement forward process, I created a <code>forward</code> function that applies the equations to the test image on the project spec. The results are shown below.
    </p>
    <img src="media5a/part1.1.jpg" style="width:300px;height:auto;" alt="part1.1.jpg">
    <div class="caption"> Test Images at Noise Levels 250, 500 and 750 </div>

    <h2> 1.2 Classical Denoising </h2>
    <h3> Approach </h3>
    <p>
        In this part, I applied <code>torchvision.transforms.functional.gaussian_blur</code> to each of the noisy images from the previous part. The results are shown below, with the top image being the noisy image and the bottom being the denoised.
    </p>
    <table border="1">
        <tr>
            <td>
                <img src="media5a/part1.2t250.jpg" style="width:300px;height:auto;" alt="part1.2t250.jpg">
            </td>
            <td>
                <img src="media5a/part1.2t500.jpg" style="width:300px;height:auto;" alt="part1.2t500.jpg">
            </td>
            <td>
                <img src="media5a/part1.2t750.jpg" style="width:300px;height:auto;" alt="part1.2t750.jpg">
            </td>
        </tr>
    </table>

    <h2> 1.3 One-Step Denoising </h2>
    <h3> Approach </h3>
    <p>
        In order to one-step denoise, I first applied the forward process to the test image then passed it through <code>stage_1.unet</code>. Then, I used the equation <code>(im_noisy - noise_est * torch.sqrt(1 - alpha_cumprod)) / torch.sqrt(alpha_cumprod)</code> to remove the noise from the image. The results are shown below:
    </p>
    <table border="1">
        <tr>
            <td>
                <img src="media5a/part1.3t250.jpg" style="width:300px;height:auto;" alt="part1.3t250.jpg">
            </td>
            <td>
                <img src="media5a/part1.3t500.jpg" style="width:300px;height:auto;" alt="part1.3t500.jpg">
            </td>
            <td>
                <img src="media5a/part1.3t730.jpg" style="width:300px;height:auto;" alt="part1.3t730.jpg">
            </td>
        </tr>
    </table>
    
    <h3> Example Images </h3>
    <table border="1">
        <tr>
            <td>
                <img src="media/woz1.jpg" style="width:300px;height:auto;" alt="woz1.jpg">
                <div class="caption"> Woz Left </div>
            </td>
            <td>
                <img src="media/woz2.jpg" style="width:300px;height:auto;" alt="woz2.jpg">
                <div class="caption"> Woz Right </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media/enclave1.jpg" style="width:300px;height:auto;" alt="enclave1.jpg">
                <div class="caption"> Enclave Left </div>
            </td>
            <td>
                <img src="media/enclave2.jpg" style="width:300px;height:auto;" alt="enclave2.jpg">
                <div class="caption"> Enclave Right </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media/hmmb1.jpg" style="width:300px;height:auto;" alt="hmmb1.jpg">
                <div class="caption"> Hearst Memorial Mining Building (HMMB) Left </div>
            </td>
            <td>
                <img src="media/hmmb2.jpg" style="width:300px;height:auto;" alt="hmmb2.jpg">
                <div class="caption"> HMMB Right </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media/apt1.jpg" style="width:300px;height:auto;" alt="apt1.jpg">
                <div class="caption"> Apartment Left </div>
            </td>
            <td>
                <img src="media/apt2.jpg" style="width:300px;height:auto;" alt="apt2.jpg">
                <div class="caption"> Apartment Left </div>
            </td>
        </tr>
    </table>


    <h1> Project 5B: Diffusion Models From Scratch! </h1>

    <h2> Background </h2>
    <p>
        brudda
    </p>
    
    <h2> 1. Training a Single-Step Denoising UNet </h2>
    <h3> Approach </h3>
    <p>
        lol
    </p>
    <h3> Harris Interest Points v.s. ANMS </h3>
    <table border="1">
        <tr>
            <td>
                <img src="media4b/woz1_harris.jpg" style="width:400px;height:auto;" alt="woz1_harris.jpg">
                <div class="caption"> Woz Left Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/woz1_anms.jpg" style="width:400px;height:auto;" alt="woz1_anms.jpg">
                <div class="caption"> Woz Left ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/woz2_harris.jpg" style="width:400px;height:auto;" alt="woz2_harris.jpg">
                <div class="caption"> Woz Right Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/woz2_anms.jpg" style="width:400px;height:auto;" alt="woz2_anms.jpg">
                <div class="caption"> Woz Right ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/enclave1_harris.jpg" style="width:400px;height:auto;" alt="enclave1_harris.jpg">
                <div class="caption"> Enclave Left Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/enclave1_anms.jpg" style="width:400px;height:auto;" alt="enclave1_anms.jpg">
                <div class="caption"> Enclave Left ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/enclave2_harris.jpg" style="width:400px;height:auto;" alt="enclave2_harris.jpg">
                <div class="caption"> Enclave Right Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/enclave2_anms.jpg" style="width:400px;height:auto;" alt="enclave2_anms.jpg">
                <div class="caption"> Enclave Right ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/apt1_harris.jpg" style="width:400px;height:auto;" alt="apt1_harris.jpg">
                <div class="caption"> Apartment Left Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/apt1_anms.jpg" style="width:400px;height:auto;" alt="apt1_anms.jpg">
                <div class="caption"> Apartment Left ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/apt2_harris.jpg" style="width:400px;height:auto;" alt="apt2_harris.jpg">
                <div class="caption"> Apartment Right Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/apt2_anms.jpg" style="width:400px;height:auto;" alt="apt2_anms.jpg">
                <div class="caption"> Apartment Right ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/hmmb1_harris.jpg" style="width:400px;height:auto;" alt="hmmb1_harris.jpg">
                <div class="caption"> HMMB Left Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/hmmb1_anms.jpg" style="width:400px;height:auto;" alt="hmmb1_anms.jpg">
                <div class="caption"> HMMB Left ANMS </div>
            </td>
        </tr>
        <tr>
            <td>
                <img src="media4b/hmmb2_harris.jpg" style="width:400px;height:auto;" alt="hmmb2_harris.jpg">
                <div class="caption"> HMMB Right Harris Interest Points </div>
            </td>
            <td>
                <img src="media4b/hmmb2_anms.jpg" style="width:400px;height:auto;" alt="hmmb2_anms.jpg">
                <div class="caption"> HMMB Right ANMS </div>
            </td>
        </tr>
    </table>
</body>
</html>
